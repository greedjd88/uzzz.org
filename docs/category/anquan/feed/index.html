<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>安全 &#8211; 有组织在!</title>
	<atom:link href="https://uzzz.org/category/anquan/feed" rel="self" type="application/rss+xml" />
	<link>http://uzzz.org/</link>
	<description></description>
	<lastBuildDate>Wed, 11 Sep 2019 14:19:17 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.2.4</generator>

<image>
	<url>https://uzzz.org/wp-content/uploads/2019/10/cropped-icon-32x32.png</url>
	<title>安全 &#8211; 有组织在!</title>
	<link>http://uzzz.org/</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>在CentOS7下使用Tor 创建匿名服务和匿名网站</title>
		<link>https://uzzz.org/article/1329.html</link>
				<pubDate>Wed, 11 Sep 2019 14:19:17 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/1329.html</guid>
				<description><![CDATA[原文链接： https://blog.byhi.org/archives/f9abf4e9.html 原文 科普下什么是暗网 暗网（英语：Dark web）是存在于黑暗网络、覆盖网络上的万维网内容，只能用特殊软体、特殊授权、或对电脑做特殊设定才能访问。暗网构成了深网的一小部分，深网网络没有被网络搜索引擎索引，有时“深网”这一术语被错误地用于指代暗网。 构成暗网的黑暗网络包括F2F的小型点对点网络以及由公共组织和个人运营的大型流行网络，如Tor、自由网、I2P和Riffle。暗网用户基于常规网络未加密的性质将其称为明网。Tor暗网可以称为洋葱区域（onionland），其使用网络顶级域后缀.onion和洋葱路由的流量匿名化技术。 —《维基百科-暗网》词条的解释 Deep web／Dark web／Darknet 的区别 深网”(Deep web) 是指服务器上可通过标准的网络浏览器和连接方法访问的页面和服务，但主流搜索引擎不会收录这些页面和服务。搜索引擎之所以不会收录深网，通常是因为网站或服务的配置错误、拒绝爬虫爬取信息、需要付费查看、需要注册查看或其他内容访问限制。 “暗网”(Dark web) 是深网中相对较小的一部分，与被故意隐藏的 Web 服务和页面有关。仅使用标准浏览器无法直接访问这些服务和页面，必须依靠使用覆盖网络 (Overlay Network)；而这种网络需要特定访问权限、代理配置、专用软件或特殊网络协议。 “黑暗网络”(Darknet) 是在网络层访问受限的框架，例如 Tor 或 I2P。私有 VPN 和网状网络 (Mesh Network) 也属于这个类别。通过这些框架的网络流量会被屏蔽。当进行数据传输时，系统只会显示您连接的黑暗网络以及您传输了多少数据，而不一定会显示您访问的网站或所涉及数据的内容。与之相反的是，直接与明网（Clean Net）或与未加密的表网服务和深网服务交互。在这种情况下，您与所请求资源之间的互联网服务提供商 (ISP) 和网络运营商可以看到您传输的流量内容。 安装 这里使用centos7作为服务器 首先扩展yum源 这里推荐下面两个yum源，建议服务器初始化的时候就是用这两个yum源作为软件的扩展 1 2 rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm 然后安装nginx 1 yum -y install nginx 安装tor 1 yum -y install tor 配置 先配置nginx 打开nginx的配置文件,让nginx监听8080端口 1 2 3 4 5 6 7 8 server { listen 8080; location / { root /www/tor; index index.html index.htm; } } 重启nginx让配置生效 1 systemctl restart nginx.service 然后到 /www/tor 里写点东西测试下: 1 echo "&#60;h2&#62;Tor site build success!&#60;/h2&#62;" &#62; /www/tor/index.html 然后用curl访问下&#160;http://localhost:8080&#160;如果可以访问，则成功生效！ 再来配置 Tor 1 vi /etc/tor/torrc 添加以下两行 1 2 HiddenServiceDir /var/lib/tor/hidden_service/ HiddenServicePort 80 127.0.0.1:8080 保存配置，然后启动Tor 1 systemctl start tor.service 当tor启动后，会创建一个私钥(/var/lib/tor/hidden_service/private_key)在你的hidden_service目录，同时创建你的 /var/lib/tor/hidden_service/hostname 里创建独一无二的.onion 主机名。 然后，用tor浏览器访问你的.onion的域名，看是否成功。]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
<div class="article-source-link">
   原文链接：<br />
  <a href="https://blog.byhi.org/archives/f9abf4e9.html" target="_blank" rel="noopener noreferrer">https://blog.byhi.org/archives/f9abf4e9.html</a>
 </div>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<p><a href="https://blog.byhi.org/archives/f9abf4e9.html" rel="nofollow" data-token="e3053c24675e406454f3d83fb35f6a1e">原文</a></p>
<h2 id="科普下什么是暗网">科普下什么是暗网</h2>
<p>暗网（英语：Dark web）是存在于黑暗网络、覆盖网络上的万维网内容，只能用特殊软体、特殊授权、或对电脑做特殊设定才能访问。暗网构成了深网的一小部分，深网网络没有被网络搜索引擎索引，有时“深网”这一术语被错误地用于指代暗网。</p>
<p>构成暗网的黑暗网络包括F2F的小型点对点网络以及由公共组织和个人运营的大型流行网络，如Tor、自由网、I2P和Riffle。暗网用户基于常规网络未加密的性质将其称为明网。Tor暗网可以称为洋葱区域（onionland），其使用网络顶级域后缀.onion和洋葱路由的流量匿名化技术。 —《维基百科-<a href="https://zh.wikipedia.org/zh-hans/%E6%9A%97%E7%BD%91" rel="nofollow" data-token="359218b2e9c3e99f498fe64d3d99ceff">暗网</a>》词条的解释</p>
<p><a id="more"></a></p>
<h2 id="Deep-web／Dark-web／Darknet-的区别">Deep web／Dark web／Darknet 的区别</h2>
<p>深网”(Deep web) 是指服务器上可通过标准的网络浏览器和连接方法访问的页面和服务，但主流搜索引擎不会收录这些页面和服务。搜索引擎之所以不会收录深网，通常是因为网站或服务的配置错误、拒绝爬虫爬取信息、需要付费查看、需要注册查看或其他内容访问限制。</p>
<p>“暗网”(Dark web) 是深网中相对较小的一部分，与被故意隐藏的 Web 服务和页面有关。仅使用标准浏览器无法直接访问这些服务和页面，必须依靠使用覆盖网络 (Overlay Network)；而这种网络需要特定访问权限、代理配置、专用软件或特殊网络协议。</p>
<p>“黑暗网络”(Darknet) 是在网络层访问受限的框架，例如 Tor 或 I2P。私有 VPN 和网状网络 (Mesh Network) 也属于这个类别。通过这些框架的网络流量会被屏蔽。当进行数据传输时，系统只会显示您连接的黑暗网络以及您传输了多少数据，而不一定会显示您访问的网站或所涉及数据的内容。与之相反的是，直接与明网（Clean Net）或与未加密的表网服务和深网服务交互。在这种情况下，您与所请求资源之间的互联网服务提供商 (ISP) 和网络运营商可以看到您传输的流量内容。</p>
<h2 id="安装">安装</h2>
<p>这里使用centos7作为服务器</p>
<h3 id="首先扩展yum源">首先扩展yum源</h3>
<p>这里推荐下面两个yum源，建议服务器初始化的时候就是用这两个yum源作为软件的扩展</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
2
</pre>
</td>
<td>
<pre>
rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm
</pre>
</td>
</tr>
</tbody>
</table>
<h3 id="然后安装nginx">然后安装nginx</h3>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
yum -y install nginx
</pre>
</td>
</tr>
</tbody>
</table>
<h3 id="安装tor">安装tor</h3>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
yum -y install tor
</pre>
</td>
</tr>
</tbody>
</table>
<h2 id="配置">配置</h2>
<h3 id="先配置nginx">先配置nginx</h3>
<p>打开nginx的配置文件,让nginx监听8080端口</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
2
3
4
5
6
7
8
</pre>
</td>
<td>
<pre>
server {
    listen 8080;

    location / {
        root   /www/tor;
        index  index.html index.htm;
    }
}
</pre>
</td>
</tr>
</tbody>
</table>
<p>重启nginx让配置生效</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
systemctl restart nginx.service
</pre>
</td>
</tr>
</tbody>
</table>
<p>然后到 /www/tor 里写点东西测试下:</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
echo "&lt;h2&gt;Tor site build success!&lt;/h2&gt;" &gt; /www/tor/index.html
</pre>
</td>
</tr>
</tbody>
</table>
<p>然后用curl访问下&nbsp;<a href="http://localhost:8080/" rel="nofollow" data-token="5d214ce3e6e0009d4238d2ba5f4520bf">http://localhost:8080</a>&nbsp;如果可以访问，则成功生效！</p>
<h3 id="再来配置-Tor">再来配置 Tor</h3>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
vi /etc/tor/torrc
</pre>
</td>
</tr>
</tbody>
</table>
<p>添加以下两行</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
2
</pre>
</td>
<td>
<pre>
HiddenServiceDir /var/lib/tor/hidden_service/
HiddenServicePort 80 127.0.0.1:8080
</pre>
</td>
</tr>
</tbody>
</table>
<p>保存配置，然后启动Tor</p>
<table>
<tbody>
<tr>
<td>
<pre>
1
</pre>
</td>
<td>
<pre>
systemctl start tor.service
</pre>
</td>
</tr>
</tbody>
</table>
<p>当tor启动后，会创建一个私钥(/var/lib/tor/hidden_service/private_key)在你的hidden_service目录，同时创建你的 /var/lib/tor/hidden_service/hostname 里创建独一无二的.onion 主机名。</p>
<p>然后，用<a href="https://www.torproject.org/" rel="nofollow" data-token="7e5e7dd2f892367d020ede518945a78a">tor浏览器</a>访问你的.onion的域名，看是否成功。</p>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>暗网：ATM攻击软件的商品化</title>
		<link>https://uzzz.org/article/746.html</link>
				<pubDate>Tue, 02 Jul 2019 10:21:51 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>
		<category><![CDATA[atm]]></category>
		<category><![CDATA[暗网]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/746.html</guid>
				<description><![CDATA[当趋势科技在2015年开始分析地下市场的恶意样本时，发现ATM相关的恶意软件并不常见。在当时，南美洲和俄罗斯的一些犯罪团伙集中研究了ATM机器的工作原理，并制作了专门的软件来攻击它们，此事名噪一时。ATM机器和我们一般使用的Windows环境有很大的不同，攻击者需要了解很多特殊的API接口以及它们是如何与特定的银行应用交互的。 此后，我们与Europol的欧洲网络犯罪中心（EC3）合作，向公众宣传了针对ATM的不同种类的网络威胁以及发展趋势。接下来我们不停针对ATM所面对的威胁发出自己的声音，并写了一篇文章详细介绍多年来出现的ATM恶意软件家族。 相关研究：针对ATM的恶意软件：全面了解各种攻击类型 现如今，在ATM恶意软件领域我们观察到了很多最新的变化，但最重要的一点不是和技术有关：ATM恶意软件已经成为地下网络犯罪论坛的一个共同而显著的特征，它已经是攻击者用来窃取现金的武器库的一部分。ATM恶意软件已经成为一种普通的商品，任何一个投资1000美元的罪犯都可以立即开始攻击ATM。 值得注意的是，这些恶意软件来自讲俄语的销售商。这当然并不代表南美黑客组织已经停止攻击ATM，而是表示俄罗斯的黑客组织拥有一个更加活跃、繁荣的非法市场，那里的恶意软件需求旺盛。 ATM恶意软件101：犯罪建议和在线帮助 当你购买网络犯罪产品时，不仅仅会得到恶意软件，通常，这些软件的销售商还会提供使用指导、建议和故障排除指南。 举个例子，最广为人知的ATM恶意软件之一，Cutlet Maker，详细描述了成功攻击所需的硬件，以及程序的详细使用说明。 Cutlet Maker软件的主要一部分：对ATM品牌和型号的描述，以及攻击它所需的设备 除了通用的“用户手册”外，卖家还分享了关于如何在不同环境下进行软件故障排除的建议。以下是本指南引言的翻译： “原始手册和第二个手册概述了软件工作所需的所有条件。Tav真的拥有一切。而在这本手册中，我将介绍如何克服有可能出现的困难，这充分结合了我自己的经验。” 我们无法确定这段话中的“Tav”是指恶意软件还是手册的编写者，亦或是该恶意软件的内部名称。这份文档将手册的作者标识为“Bogdan”。 上图是Cutlet Maker故障排除指南的屏幕截图。作者介绍了ATM机的USB端口位置，以及如何设计一个连接USB电缆和访问内部USB端口的工具。 这份指南还详细描述了ATM机器的内外部细节。以下是卖家建议的翻译： “我们需要的端口位于ATM上方塑料盖的后面，紧贴其后的往往是银行的广告纸。这个盖子通过三点固定，它们分别位于塑料盖的左上侧、中间和右侧。轻轻地撬动工具，避免盖子破裂，然后将其放在ATM的顶部。接下来我们拿出一个手电筒往里照，可以看到了以下画面：” 以上图片描述了一旦移除内部USB端口的面板，攻击者将看到什么。卖家还提供了一些使用手机的建议，以躲避执法部门的追踪。 除此教他人如何物理攻击ATM，卖家还会提供一些软件技术支持。例如，如果目标计算机受防病毒程序保护，如何禁用已安装的安全软件。 “就像禁用Adobe服务一样。我们先进入任务管理器的“Startup”选项卡，取消其开机运行。然后进入防病毒软件文件夹c:/program…/our antivirus/，将.exe的名称更改为任何其他名称。 你现在已关闭防病毒软件，可以从闪存中运行恶意软件了。” 以上这种方法是一种很简单的方法，不适用于更先进的ATM安全解决方案。但是，并不是所有的ATM都使用了最新的安全方案。 上图主要说明如何禁用防病毒程序。 案例研究：ATM恶意软件经销商 ATM恶意软件正在成为地下犯罪论坛中的常见产品，它也不再是以前那种奇特或小众的东西了。一个卖家甚至可以提供了多个种类的ATM恶意软件。这些卖家也不是恶意软件的作者，他们基本上都是经销商，从销售中提成的。 上图为一个地下犯罪论坛的恶意软件列表。 以上为三个地下犯罪论坛的软件列表，显示同一卖家提供了不同种类的ATM恶意软件。 在浏览这些犯罪论坛时，我们注意到了一个专门出售ATM恶意软件的经销商，我们决定仔细查看用户的个人资料。M_xxxxx发布了多个帖子，在论坛上兜售许多不同种类的ATM恶意软件。 根据其买家和其他论坛用户的评论，这个用户似乎不是这些软件的原始作者，只是个经销商。这个人在多个帖子中表示：“我以更低的价格销售相同的软件”。此外，此人还有视频说明，演示恶意软件的工作原理，视频发布在网站Darkvideo上。不过，也有其他论坛用户指责这个卖家销售的软件无效。他旁注中的俄语像是用机器翻译的，这意味着他的母语不是俄罗斯语。 M_xxxxx的各种ATM恶意软件的价格如下： Winpot——1000美元 HelloWorld——1000美元 Annuit Coeptis——500美元 Alice——300美元 Cutlet Maker——200美元 ATM恶意软件或将影响银行安全 在过去两年中，地下犯罪论坛中提供的ATM恶意软件数量显著增加。这种类型的恶意软件过去只专属于知名犯罪团伙，现在正成为一种主流工具，很多人都有购买意向。总而言之，任何有几百美元的犯罪分子都可以攻击ATM了。 有些恶意软件纯粹是骗局，但另外一些似乎能正常攻击。事实上，我们已经看到不少买家的好评，特别是一些知名的恶意软件，更是广受欢迎。这让人想起银行木马的那段“群雄逐鹿”的时代。 虽然不少针对ATM的攻击手段还很低级，但不幸的是，这个世界还存在很多无保护的ATM机，可能只有发生大规模的ATM攻击，这种情况才会逐渐改善。 请记住，随着时间推移，那些未受保护的ATM遭受攻击的风险会疯狂增加。 本文由白帽汇整理并翻译，不代表白帽汇任何观点和立场：https://nosec.org/home/detail/2740.html 来源：https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/crimeware-for-sale-the-commoditization-of-atm-malware-in-the-cybercriminal-underground?utm_source=trendmicroresearch&#38;utm_medium=smk&#38;utm_campaign=0619_atm]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/201907021824273.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>当趋势科技在2015年开始分析地下市场的恶意样本时，发现ATM相关的恶意软件并不常见。在当时，南美洲和俄罗斯的一些犯罪团伙集中研究了ATM机器的工作原理，并制作了专门的软件来攻击它们，此事名噪一时。ATM机器和我们一般使用的Windows环境有很大的不同，攻击者需要了解很多特殊的API接口以及它们是如何与特定的银行应用交互的。</p>
<p>此后，我们与Europol的欧洲网络犯罪中心（EC3）合作，向公众宣传了针对ATM的不同种类的网络威胁以及发展趋势。接下来我们不停针对ATM所面对的威胁发出自己的声音，并写了一篇文章详细介绍多年来出现的ATM恶意软件家族。</p>
<p>相关研究：<a href="https://documents.trendmicro.com/assets/white_papers/wp-cashing-in-on-atm-malware.pdf" rel="nofollow" data-token="c7d33154e04d709600f03cc09159e587">针对ATM的恶意软件：全面了解各种攻击类型</a></p>
<p>现如今，在ATM恶意软件领域我们观察到了很多最新的变化，但最重要的一点不是和技术有关：ATM恶意软件已经成为地下网络犯罪论坛的一个共同而显著的特征，它已经是攻击者用来窃取现金的武器库的一部分。ATM恶意软件已经成为一种普通的商品，任何一个投资1000美元的罪犯都可以立即开始攻击ATM。</p>
<p>值得注意的是，这些恶意软件来自讲俄语的销售商。这当然并不代表南美黑客组织已经停止攻击ATM，而是表示俄罗斯的黑客组织拥有一个更加活跃、繁荣的非法市场，那里的恶意软件需求旺盛。</p>
<h2><a id="ATM101_12"></a>ATM恶意软件101：犯罪建议和在线帮助</h2>
<p>当你购买网络犯罪产品时，不仅仅会得到恶意软件，通常，这些软件的销售商还会提供使用指导、建议和故障排除指南。</p>
<p>举个例子，最广为人知的ATM恶意软件之一，Cutlet Maker，详细描述了成功攻击所需的硬件，以及程序的详细使用说明。<br /> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190702182447495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>Cutlet Maker软件的主要一部分：对ATM品牌和型号的描述，以及攻击它所需的设备</p>
<p>除了通用的“用户手册”外，卖家还分享了关于如何在不同环境下进行软件故障排除的建议。以下是本指南引言的翻译：</p>
<pre><code>“原始手册和第二个手册概述了软件工作所需的所有条件。Tav真的拥有一切。而在这本手册中，我将介绍如何克服有可能出现的困难，这充分结合了我自己的经验。”

</code></pre>
<p>我们无法确定这段话中的“Tav”是指恶意软件还是手册的编写者，亦或是该恶意软件的内部名称。这份文档将手册的作者标识为“Bogdan”。</p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190702182501225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>上图是Cutlet Maker故障排除指南的屏幕截图。作者介绍了ATM机的USB端口位置，以及如何设计一个连接USB电缆和访问内部USB端口的工具。</p>
<p>这份指南还详细描述了ATM机器的内外部细节。以下是卖家建议的翻译：</p>
<p>“我们需要的端口位于ATM上方塑料盖的后面，紧贴其后的往往是银行的广告纸。这个盖子通过三点固定，它们分别位于塑料盖的左上侧、中间和右侧。轻轻地撬动工具，避免盖子破裂，然后将其放在ATM的顶部。接下来我们拿出一个手电筒往里照，可以看到了以下画面：”<br /> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190702182512612.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>以上图片描述了一旦移除内部USB端口的面板，攻击者将看到什么。卖家还提供了一些使用手机的建议，以躲避执法部门的追踪。</p>
<p>除此教他人如何物理攻击ATM，卖家还会提供一些软件技术支持。例如，如果目标计算机受防病毒程序保护，如何禁用已安装的安全软件。</p>
<pre><code>“就像禁用Adobe服务一样。我们先进入任务管理器的“Startup”选项卡，取消其开机运行。然后进入防病毒软件文件夹c:/program…/our antivirus/，将.exe的名称更改为任何其他名称。

你现在已关闭防病毒软件，可以从闪存中运行恶意软件了。”

</code></pre>
<p>以上这种方法是一种很简单的方法，不适用于更先进的ATM安全解决方案。但是，并不是所有的ATM都使用了最新的安全方案。</p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190702182540940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>上图主要说明如何禁用防病毒程序。</p>
<h2><a id="ATM_56"></a>案例研究：ATM恶意软件经销商</h2>
<p>ATM恶意软件正在成为地下犯罪论坛中的常见产品，它也不再是以前那种奇特或小众的东西了。一个卖家甚至可以提供了多个种类的ATM恶意软件。这些卖家也不是恶意软件的作者，他们基本上都是经销商，从销售中提成的。<br /> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190702182551304.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>上图为一个地下犯罪论坛的恶意软件列表。</p>
<p><img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019070218260086.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05PU0VDMjAxOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>以上为三个地下犯罪论坛的软件列表，显示同一卖家提供了不同种类的ATM恶意软件。</p>
<p>在浏览这些犯罪论坛时，我们注意到了一个专门出售ATM恶意软件的经销商，我们决定仔细查看用户的个人资料。M_xxxxx发布了多个帖子，在论坛上兜售许多不同种类的ATM恶意软件。</p>
<p>根据其买家和其他论坛用户的评论，这个用户似乎不是这些软件的原始作者，只是个经销商。这个人在多个帖子中表示：“我以更低的价格销售相同的软件”。此外，此人还有视频说明，演示恶意软件的工作原理，视频发布在网站Darkvideo上。不过，也有其他论坛用户指责这个卖家销售的软件无效。他旁注中的俄语像是用机器翻译的，这意味着他的母语不是俄罗斯语。</p>
<p>M_xxxxx的各种ATM恶意软件的价格如下：</p>
<pre><code>Winpot——1000美元

HelloWorld——1000美元

Annuit Coeptis——500美元

Alice——300美元

Cutlet Maker——200美元

</code></pre>
<h2><a id="ATM_86"></a>ATM恶意软件或将影响银行安全</h2>
<p>在过去两年中，地下犯罪论坛中提供的ATM恶意软件数量显著增加。这种类型的恶意软件过去只专属于知名犯罪团伙，现在正成为一种主流工具，很多人都有购买意向。总而言之，任何有几百美元的犯罪分子都可以攻击ATM了。</p>
<p>有些恶意软件纯粹是骗局，但另外一些似乎能正常攻击。事实上，我们已经看到不少买家的好评，特别是一些知名的恶意软件，更是广受欢迎。这让人想起银行木马的那段“群雄逐鹿”的时代。</p>
<p>虽然不少针对ATM的攻击手段还很低级，但不幸的是，这个世界还存在很多无保护的ATM机，可能只有发生大规模的ATM攻击，这种情况才会逐渐改善。</p>
<p>请记住，随着时间推移，那些未受保护的ATM遭受攻击的风险会疯狂增加。</p>
<pre><code>本文由白帽汇整理并翻译，不代表白帽汇任何观点和立场：https://nosec.org/home/detail/2740.html
来源：https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/crimeware-for-sale-the-commoditization-of-atm-malware-in-the-cybercriminal-underground?utm_source=trendmicroresearch&amp;utm_medium=smk&amp;utm_campaign=0619_atm

</code></pre>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>使用Tor设置SSH服务器以隐藏Shodan和黑客</title>
		<link>https://uzzz.org/article/1037.html</link>
				<pubDate>Fri, 31 May 2019 08:17:19 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/1037.html</guid>
				<description><![CDATA[内容目录 前述 为什么要用Tor设置SSH？ 步骤1：安装Tor 步骤2：在服务器上创建洋葱服务 步骤3：验证洋葱服务是否正常（可选） 步骤4：使SSH服务保密 步骤5：使用Tor连接到SSH服务器 步骤6：确保Shodan无法看到SSH服务 结论 前述 下一个libSSH或OpenSSH漏洞利用可能就在眼前。在黑客找到绕过保护服务器的密码的新方法之前，请将您的SSH服务保留在Shodan的数据库之外。 Shodan被称为“ 黑客的搜索引擎 ”，因为它实际上是一个可搜索的互联网连接设备和服务器数据库。它允许任何人搜索网络摄像头，路由器，服务器，Raspberry Pis，交通信号灯，销售点系统，工业控制系统等等。 Web工具通过随机迭代现有的每个可能的IP地址（无论是在线还是未使用）并尝试在不同端口上提取服务标志来实现此目的。服务标志通常存储有关正在运行的服务的元数据，例如服务名称，类型和版本号。 为什么要用Tor设置SSH？ 任何连接互联网的设备都将不可避免地被Shodan和其他数据库（如Censys）扫描。黑客使用这些数据库来定位过时的易受攻击的服务器。即使是经常更新服务器并遵循最佳安全实践的系统管理员也会受到攻击。libSSH认证绕过漏洞是一个很好的例子。 libSSH vuln允许黑客在没有首先执行身份验证的情况下连接到SSH服务。最完整的最新服务仍然容易受到这种攻击，并使许多服务器和网站面临风险。更重要的是，完全更新的系统仍然暴露于尚未披露的漏洞。目前还不知道有多少未公开的OpenSSH漏洞存在。 Tor 洋葱服务可以帮助减少暴露。就像使用标准Web浏览器无法访问洋葱网站一样，SSH服务只能配置为允许通过Tor访问。它可以使搜索引擎完全无法访问，像Shodan一样，并且黑客更难以找到。 步骤1：安装Tor 我们需要做的第一件事是在虚拟专用服务器（VPS）和客户端计算机上安装Tor。客户端可以是Debian，Ubuntu或Kali系统。MacOS和Windows 10用户可以查看官方Tor Project文档，以便正确安装tor。对于大多数读者来说，SSH服务器很可能是Debian VPS。但是，这可以在Ubuntu桌面或Raspberry Pi上进行设置，适用于那些希望远程访问家中计算机的用户。 Tor在许多Linux存储库中都可用。在大多数情况下，无法可靠地维护或更新软件包，这意味着可能缺少关键稳定性和安全性更新。此外，匿名软件应始终直接从源（即torproject.org）获取。 登录到您的SSH服务器并使用以下echo命令将Tor Project的存储库添加到您的APT存储库列表，该命令在Debian中有效。 ~$ echo -e "deb https://deb.torproject.org/torproject.org $(lsb_release -sc) main \ndeb-src https://deb.torproject.org/torproject.org $(lsb_release -sc) main" &#62; /etc/apt/sources.list.d/tor.list 更多阅读，参阅国外课栈新址https://via-dean.com]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div id="content_views" class="markdown_views prism-atom-one-dark">
  <!-- flowchart 箭头图标 勿删 --><br />
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> </p>
<p>内容目录</p>
<p>前述<br /> 为什么要用Tor设置SSH？<br /> 步骤1：安装Tor<br /> 步骤2：在服务器上创建洋葱服务<br /> 步骤3：验证洋葱服务是否正常（可选）<br /> 步骤4：使SSH服务保密<br /> 步骤5：使用Tor连接到SSH服务器<br /> 步骤6：确保Shodan无法看到SSH服务<br /> 结论</p>
<p>前述<br /> 下一个libSSH或OpenSSH漏洞利用可能就在眼前。在黑客找到绕过保护服务器的密码的新方法之前，请将您的SSH服务保留在Shodan的数据库之外。</p>
<p>Shodan被称为“ 黑客的搜索引擎 ”，因为它实际上是一个可搜索的互联网连接设备和服务器数据库。它允许任何人搜索网络摄像头，路由器，服务器，Raspberry Pis，交通信号灯，销售点系统，工业控制系统等等。</p>
<p>Web工具通过随机迭代现有的每个可能的IP地址（无论是在线还是未使用）并尝试在不同端口上提取服务标志来实现此目的。服务标志通常存储有关正在运行的服务的元数据，例如服务名称，类型和版本号。</p>
<p>为什么要用Tor设置SSH？<br /> 任何连接互联网的设备都将不可避免地被Shodan和其他数据库（如Censys）扫描。黑客使用这些数据库来定位过时的易受攻击的服务器。即使是经常更新服务器并遵循最佳安全实践的系统管理员也会受到攻击。libSSH认证绕过漏洞是一个很好的例子。</p>
<p>libSSH vuln允许黑客在没有首先执行身份验证的情况下连接到SSH服务。最完整的最新服务仍然容易受到这种攻击，并使许多服务器和网站面临风险。更重要的是，完全更新的系统仍然暴露于尚未披露的漏洞。目前还不知道有多少未公开的OpenSSH漏洞存在。</p>
<p>Tor 洋葱服务可以帮助减少暴露。就像使用标准Web浏览器无法访问洋葱网站一样，SSH服务只能配置为允许通过Tor访问。它可以使搜索引擎完全无法访问，像Shodan一样，并且黑客更难以找到。</p>
<p>步骤1：安装Tor<br /> 我们需要做的第一件事是在虚拟专用服务器（VPS）和客户端计算机上安装Tor。客户端可以是Debian，Ubuntu或Kali系统。MacOS和Windows 10用户可以查看官方Tor Project文档，以便正确安装tor。对于大多数读者来说，SSH服务器很可能是Debian VPS。但是，这可以在Ubuntu桌面或Raspberry Pi上进行设置，适用于那些希望远程访问家中计算机的用户。</p>
<p>Tor在许多Linux存储库中都可用。在大多数情况下，无法可靠地维护或更新软件包，这意味着可能缺少关键稳定性和安全性更新。此外，匿名软件应始终直接从源（<a href="http://xn--torproject-4x4q.org" rel="nofollow" data-token="ace5f2dd6ca266854c1fdbb1223a6e9e">即torproject.org</a>）获取。</p>
<p>登录到您的SSH服务器并使用以下echo命令将Tor Project的存储库添加到您的APT存储库列表，该命令在Debian中有效。</p>
<pre><code>~$ echo -e "deb https://deb.torproject.org/torproject.org $(lsb_release -sc) main \ndeb-src https://deb.torproject.org/torproject.org $(lsb_release -sc) main" &gt; /etc/apt/sources.list.d/tor.list
</code></pre>
<p><strong><a href="https://via-dean.com/set-up-an-ssh-server-with-tor-to-hide-it-from-shodan-hackers/" rel="nofollow" data-token="11d0b0e581a3c16171fba681e022cece">更多阅读，参阅国外课栈新址https://via-dean.com</a></strong></p>
</p></div>
<link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-e9f16cbbc2.css" rel="stylesheet">
</div>
]]></content:encoded>
										</item>
		<item>
		<title>Python中更改Tor身份</title>
		<link>https://uzzz.org/article/1114.html</link>
				<pubDate>Tue, 08 Jan 2019 07:12:47 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/1114.html</guid>
				<description><![CDATA[https://stackoverflow.com/questions/9887505/how-to-change-tor-identity-in-python https://www.cnblogs.com/nuolan/p/5729650.html &#160; import urllib2 from TorCtl import TorCtl proxy_support = urllib2.ProxyHandler({"http" : "127.0.0.1:8118"}) opener = urllib2.build_opener(proxy_support) def newId(): conn = TorCtl.connect(controlAddr="127.0.0.1", controlPort=9051, passphrase="your_password") conn.send_signal("NEWNYM") for i in range(0, 10): print "case "+str(i+1) newId() proxy_support = urllib2.ProxyHandler({"http" : "127.0.0.1:8118"}) urllib2.install_opener(opener) print(urllib2.urlopen("http://www.ifconfig.me/ip").read())]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<p><a href="https://stackoverflow.com/questions/9887505/how-to-change-tor-identity-in-python" rel="nofollow" data-token="827adb0fa6df3eca6a35d92c40e3c38d">https://stackoverflow.com/questions/9887505/how-to-change-tor-identity-in-python</a></p>
<p><a href="https://www.cnblogs.com/nuolan/p/5729650.html" rel="nofollow" data-token="39f8ea145797a12c4dd64ad8e52bad53">https://www.cnblogs.com/nuolan/p/5729650.html</a></p>
<p>&nbsp;</p>
<pre>
import urllib2
from TorCtl import TorCtl
proxy_support = urllib2.ProxyHandler({"http" : "127.0.0.1:8118"})
opener = urllib2.build_opener(proxy_support) 
def newId():
 conn = TorCtl.connect(controlAddr="127.0.0.1", controlPort=9051, passphrase="your_password")
 conn.send_signal("NEWNYM")
for i in range(0, 10):
 print "case "+str(i+1)
 newId()
 proxy_support = urllib2.ProxyHandler({"http" : "127.0.0.1:8118"})
 urllib2.install_opener(opener)
 print(urllib2.urlopen("http://www.ifconfig.me/ip").read())</pre>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>kali下ONIOFF，暗网链接可用性检测</title>
		<link>https://uzzz.org/article/819.html</link>
				<pubDate>Wed, 28 Feb 2018 01:56:33 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/819.html</guid>
				<description><![CDATA[参考：https://www.youtube.com/watch?v=lPBYH5hiojYhttps://github.com/k4m4/onioff cd /tmp git clone https://github.com/k4m4/onioff cd onioff sudo pip install -r requirements.txt python onioff.py -h service tor start python onioff.py -f onion.txt -o output.txt #自动检测onion里面的暗网链接是否正常，然后把结果输出到output里面 onion.txt]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<div>
<div class="markdown_views">
<div class="markdown_views-free">
<blockquote>
<p>参考：<br /><a href="https://link.jianshu.com?t=https://www.youtube.com/watch?v=lPBYH5hiojY" rel="nofollow" data-token="a49cb85dd4a491b0a2f67e930694d806">https://www.youtube.com/watch?v=lPBYH5hiojY</a><br /><a href="https://link.jianshu.com?t=https://github.com/k4m4/onioff" rel="nofollow" data-token="31d64f10b3e58ef6f68cc4fd09cfd193">https://github.com/k4m4/onioff</a></p>
</blockquote>
<pre><code>cd /tmp
git clone https://github.com/k4m4/onioff
cd onioff
sudo pip install -r requirements.txt
python onioff.py -h

service tor start

python onioff.py -f onion.txt -o output.txt
#自动检测onion里面的暗网链接是否正常，然后把结果输出到output里面
</code></pre>
<div class="image-package">
<div class="image-container">
<div class="image-view">
        <img src="https://uzshare.com/_p?https://img-blog.csdn.net/2018022811310170?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZGFqaXR1aTIwMjQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br />
        
       </div>
</p></div>
<div class="image-caption">
       onion.txt
      </div>
</p></div>
</p></div>
</p></div>
</p></div>
<div></div>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>kali下一个虚假的tor访问方案</title>
		<link>https://uzzz.org/article/1099.html</link>
				<pubDate>Wed, 28 Feb 2018 01:51:23 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/1099.html</guid>
				<description><![CDATA[1、并没有真的安装tor浏览器，但是却使用了tor的服务、2、项目地址：https://github.com/susmithHCK/torghost3、使用说明，可以直接在项目地址查看使用说明。通过tor官方的检查，识别你使用了tor服务，其实你用的是自己的浏览器，只是开了一个代理。]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<div>
<div class="markdown_views">
<div class="markdown_views-free">
<p>1、并没有真的安装tor浏览器，但是却使用了tor的服务、<br />2、项目地址：<a href="https://link.jianshu.com?t=https://github.com/susmithHCK/torghost" rel="nofollow" data-token="6e6b6eec06934df872edcd021726b266">https://github.com/susmithHCK/torghost</a><br />3、<a href="https://link.jianshu.com?t=https://www.youtube.com/watch?v=L8xtOYTw2lw" rel="nofollow" data-token="d6afba646c4821b59d93cf00746663ca">使用说明</a>，可以直接在项目地址查看使用说明。<br />通过tor官方的检查，识别你使用了tor服务，其实你用的是自己的浏览器，只是开了一个代理。</p>
</p></div>
</p></div>
</p></div>
<div></div>
</p></div>
</div>
]]></content:encoded>
										</item>
		<item>
		<title>由http暗藏通道看网络安全</title>
		<link>https://uzzz.org/article/998.html</link>
				<pubDate>Wed, 13 Mar 2002 00:58:00 +0000</pubDate>
		<dc:creator><![CDATA[fandyvon]]></dc:creator>
				<category><![CDATA[安全]]></category>

		<guid isPermaLink="false">https://uzzz.org/article/998.html</guid>
				<description><![CDATA[由http暗藏通道看网络安全 &#160; 内容： 什么是http暗藏通道 什么是Httptunnel Httptunnel带来的安全问题 一些解决思路 总结 参考资料 关于作者 宫一鸣 (yiming@security.zz.ha.cn)中国电信网络安全小组核心成员2001 年 12 月 通过本文的httptunnel 技术同时逃过了防火墙的屏蔽以及系统的追踪试验，我们可以看到网络安全仅仅依靠某种或某几种手段是不可靠的，同时对安全系统的盲目性依赖往往会造成巨大的安全隐患。希望通过本文能引起管理员对网络安全防护系统的思考。 什么是http暗藏通道 什么是局域网安全，系统管理员怎样才能保障局域网的安全？这是一个不断变化的安全概念，很长的一个时期以来，在局域网与外界互联处放置一个防火墙，严格控制开放的端口，就能在很大程度上掌握安全的主动权，方便的控制网内外用户所能使用的服务。比如，在防火墙上仅仅开放80，53两个端口，那么无论是内部还是外面的恶意人士都将无法使用一些已经证明比较危险的服务。 但要注意一点，防火墙在某种意义上是很愚蠢的，管理员对防火墙的过分依赖以及从而产生的懈怠情绪将不可避免的形成安全上的重大隐患，作为一个证明，&#8221;通道&#8221;技术就是一个很好的例子，这也是本文要讨论的。 那么什么是通道呢？这里所谓的通道，是指一种绕过防火墙端口屏蔽的通讯方式。防火墙两端的数据包封装在防火墙所允许通过的数据包类型或是端口上，然后穿过防火墙与对端通讯，当封装的数据包到达目的地时，再将数据包还原，并将还原后的数据包交送到相应的服务上。举例如下： A主机系统在防火墙之后，受防火墙保护，防火墙配置的访问控制原则是只允许80端口的数据进出，B主机系统在防火墙之外，是开放的。现在假设需要从A系统Telnet到B系统上去，怎么办？使用正常的telnet肯定是不可能了，但我们知道可用的只有80端口，那么这个时候使用Httptunnel通道，就是一个好的办法，思路如下： 在A机器上起一个tunnel的client端，让它侦听本机的一个不被使用的任意指定端口，如1234，同时将来自1234端口上的数据指引到远端（B机）的80端口上（注意，是80端口，防火墙允许通过），然后在B机上起一个server，同样挂接在80端口上，同时指引80端口的来自client的转发到本机的telnet服务端口23，这样就ok了。现在在A机上telnet本机端口1234，根据刚才的设置数据包会被转发到目标端口为80的B机，因为防火墙允许通过80端口的数据，因此数据包畅通的穿过防火墙，到达B机。此时B机在80端口侦听的进程收到来自A的数据包，会将数据包还原，再交还给telnet进程。当数据包需要由B到A返回时，将由80端口再回送，同样可以顺利的通过防火墙。 实际上tunnel概念已经产生很久了，而且很有可能读者使用过类似的技术，比如下面的网址http://www.http-tunnel.com。它是一个专业提供tunnel服务的公司，通过他们的在线tunnel server,局域网内的用户可以使用被防火墙所屏蔽的ICQ，E-MAIL，pcanywhere， AIM，MSN， Yahoo，Morpheus，Napster等等诸多软件。我们看到，这里有ICQ,Napster等软件，相信我们的读者很多都使用过走proxy的ICQ,OICQ等等，其实他们的原理是差不多的。 什么是Httptunnel 作为一个实际的例子，我们下面来介绍一个在&#8221;非公开领域&#8221;使用的的通道软件，httptunnel。在httptunnel主页（请参阅参考资料）上有这么一端话，httptunnel creates a bidirectional virtual data connection tunnelled in HTTP requests. The HTTP requests can be sent via an HTTP proxy if so desired. This can be useful for users behind restrictive firewalls. If WWW access is allowed through a HTTP proxy, it&#8217;s possible to use httptunnel and, say, telnet or PPP to connect to a computer outside the firewall. 从这段说明中我们可以看出来它就是我们今天说要介绍的tunnel技术的一个证明，我们下面大致介绍一下它的使用。 httptunnel目前比较稳定的版本是3.0.5, 支持各种常见的unix系统，包括window平台。可以从相关站点（请参阅参考资料）下载，它的安装是比较简单的，照INSTALL文件做就可以了，这里不介绍。 整个软件安装完毕后，我们会得到两个关键文件，htc和hts,其中htc是客户端（c），而hts是server(s)端，我们来看看具体怎么使用的。 假设有A（域名client.yiming.com)机，B(域名server.yiming.com)机，两机均为solaris环境，A机在防火墙保护中，B机在防火墙以外，防火墙的管理员控制了访问规则，仅ALLOW 80和53端口的进出数据包。而我们的任务是要利用Httptunnel从A机telnet到B机上，穿过防火墙的限制。操作如下： 首先我们在A上启动client端，命令很简单：client.yiming.com#htc -F 1234 server.yiming.com:80， 系统回到提示符下，此刻我们用netstat -an 可以看到系统内多出了1234端口的侦听 *.1234 *.* 0 0 0 0 LISTEN 然后我们在B机上启动server端，命令如下：server.yiming.com#hts -F localhost:23 80 系统回到提示符下，此刻我们用netstat看 *.80 *.* 0 0 0 0 LISTEN 80端口处于侦听状态，需要注意的是，如果系统本身跑的有web服务（80端口本身处于侦听），并不会影响Httptunnel的工作。 Ok,server以及client端都启动了，我们可以开始我们的&#8221;通道&#8221;试验了，在client.yiming.com上执行一下如下命令看看： Client.yiming.com#telnet localhost 1234 Trying 0.0.0.0... Connected to 0. Escape character is '^]'. SunOS 5.7 This is yiming's private box! Any question,contact me with yiming@security.zz.ha.cn login: 看到B机的登录提示符了,输入账号密码看看是否工作正常？ Login:yiming Password: (omit here;) ) sever.yiming.com# ls bak check go httpd lost+found mrtg run soft wg OK! 工作正常，和正常的telnet没有什么差别。 仔细观察整个过程，会发现在最开始的地方显示的是Trying 0.0.0.0&#8230;，Connected to 0.而不是Trying server.yiming.com…,Connect to server.yiming.com，这就很直观的可以看出来client端是转发1234数据包到本机80端口的。（然后再转发到远端）而不是直接连接远端的B机。 上面是比较直观的测试，为了进一步验证server和client之间不是通过23端口通讯，我们抓取数据包来看看。我们在server起个抓包工具tcpdump（请参阅参考资料）瞧瞧。 server.yiming.com#tcpdump host client.yiming.com tcpdump: listening on]]></description>
								<content:encoded><![CDATA[<div id="article_content" class="article_content clearfix">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-3019150162.css">
<div class="htmledit_views" id="content_views">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
<tr valign="top">
<td><span class="atitle">由http暗藏通道看网络安全</span></td>
<td width="8"><img alt="" border="0" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="8"></td>
<td>&nbsp;</td>
<td width="6"><img alt="" border="0" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="6"></td>
</tr>
<p>    <!-- Black line separator --></p>
<tr valign="top">
<td bgcolor="#000000" colspan="5"><img alt="" border="0" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="100"></td>
</tr>
<tr valign="top">
<td bgcolor="#ffffff" colspan="5"><img alt="" border="0" height="8" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="100"></td>
</tr>
</tbody>
</table>
<p>  <!-- END HEADER AREA --><br />
  <!-- START BODY AREA --></p>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
<tr valign="top">
<td width="10"><img alt="" border="0" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="10"></td>
<td width="100%">
<table align="right" border="0" cellpadding="0" cellspacing="0" width="168">
<tbody>
<tr>
         <!-- Sidebar Gutter --></p>
<td width="8"><img alt="" height="21" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="5"></td>
<td width="160">
          <!-- Start TOC --> </p>
<table border="0" cellpadding="0" cellspacing="0" width="160">
<tbody>
<tr>
<td bgcolor="#000000" height="1" width="160"><img alt="" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="160"></td>
</tr>
<tr>
<td height="5" style="background-image:url(&quot;/developerWorks/i/bg-gold.gif&quot;);"><b>内容：</b></td>
</tr>
<tr>
<td bgcolor="#666666" height="1" width="160"><img alt="" height="1" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="160"></td>
</tr>
<tr>
<td align="right">
<table border="0" cellpadding="3" cellspacing="0" width="98%">
<tbody>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#1" rel="nofollow" data-token="481732a599c867845d08553ce227a6cb">什么是http暗藏通道</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#2" rel="nofollow" data-token="342affceb9e3cccf4aeb1bcefa0112b4">什么是Httptunnel</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#3" rel="nofollow" data-token="2e2e443211fa7f9e515a63f7ca8d8785">Httptunnel带来的安全问题</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#4" rel="nofollow" data-token="65912ad933223e491cfe608d00460f88">一些解决思路</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#5" rel="nofollow" data-token="c0b0887ceaf69e55244df2265c5961ee">总结</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a></td>
</tr>
<tr>
<td><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#author1" rel="nofollow" data-token="b11ae42788042ca0cda5301ca6cb4ce2">关于作者</a></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>          <!-- End TOC --></p>
<table border="0" cellpadding="0" cellspacing="0" width="160">
<tbody>
<tr>
<td bgcolor="#000000" colspan="2" height="2" width="150"><img alt="" height="2" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="160"></td>
</tr>
<tr>
<td bgcolor="#ffffff" colspan="2" height="2" width="150"><img alt="" height="2" src="http://www-900.ibm.com/developerWorks/i/c.gif" width="160"></td>
</tr>
</tbody>
</table>
<p>          <!-- END STANDARD SIDEBAR AREA --></td>
</tr>
</tbody>
</table>
<p><a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#author1" rel="nofollow" data-token="b11ae42788042ca0cda5301ca6cb4ce2">宫一鸣</a> (<a href="mailto:yiming@security.zz.ha.cn" rel="nofollow" data-token="51489f3b54edee482a93b1e4be91024c">yiming@security.zz.ha.cn</a>)<br />中国电信网络安全小组核心成员<br />2001 年 12 月</p>
<blockquote><p>
       通过本文的httptunnel 技术同时逃过了防火墙的屏蔽以及系统的追踪试验，我们可以看到网络安全仅仅依靠某种或某几种手段是不可靠的，同时对安全系统的盲目性依赖往往会造成巨大的安全隐患。希望通过本文能引起管理员对网络安全防护系统的思考。
      </p></blockquote>
<p><a name="1"><span class="atitle2">什么是http暗藏通道</span></a> <br />什么是局域网安全，系统管理员怎样才能保障局域网的安全？这是一个不断变化的安全概念，很长的一个时期以来，在局域网与外界互联处放置一个防火墙，严格控制开放的端口，就能在很大程度上掌握安全的主动权，方便的控制网内外用户所能使用的服务。比如，在防火墙上仅仅开放80，53两个端口，那么无论是内部还是外面的恶意人士都将无法使用一些已经证明比较危险的服务。</p>
<p>但要注意一点，防火墙在某种意义上是很愚蠢的，管理员对防火墙的过分依赖以及从而产生的懈怠情绪将不可避免的形成安全上的重大隐患，作为一个证明，&#8221;通道&#8221;技术就是一个很好的例子，这也是本文要讨论的。</p>
<p>那么什么是通道呢？这里所谓的通道，是指一种绕过防火墙端口屏蔽的通讯方式。防火墙两端的数据包封装在防火墙所允许通过的数据包类型或是端口上，然后穿过防火墙与对端通讯，当封装的数据包到达目的地时，再将数据包还原，并将还原后的数据包交送到相应的服务上。举例如下：</p>
<p>A主机系统在防火墙之后，受防火墙保护，防火墙配置的访问控制原则是只允许80端口的数据进出，B主机系统在防火墙之外，是开放的。现在假设需要从A系统Telnet到B系统上去，怎么办？使用正常的telnet肯定是不可能了，但我们知道可用的只有80端口，那么这个时候使用Httptunnel通道，就是一个好的办法，思路如下：</p>
<p>在A机器上起一个tunnel的client端，让它侦听本机的一个不被使用的任意指定端口，如1234，同时将来自1234端口上的数据指引到远端（B机）的80端口上（注意，是80端口，防火墙允许通过），然后在B机上起一个server，同样挂接在80端口上，同时指引80端口的来自client的转发到本机的telnet服务端口23，这样就ok了。现在在A机上telnet本机端口1234，根据刚才的设置数据包会被转发到目标端口为80的B机，因为防火墙允许通过80端口的数据，因此数据包畅通的穿过防火墙，到达B机。此时B机在80端口侦听的进程收到来自A的数据包，会将数据包还原，再交还给telnet进程。当数据包需要由B到A返回时，将由80端口再回送，同样可以顺利的通过防火墙。</p>
<p>实际上tunnel概念已经产生很久了，而且很有可能读者使用过类似的技术，比如下面的网址http://www.http-tunnel.com。它是一个专业提供tunnel服务的公司，通过他们的在线tunnel server,局域网内的用户可以使用被防火墙所屏蔽的ICQ，E-MAIL，pcanywhere， AIM，MSN， Yahoo，Morpheus，Napster等等诸多软件。我们看到，这里有ICQ,Napster等软件，相信我们的读者很多都使用过走proxy的ICQ,OICQ等等，其实他们的原理是差不多的。</p>
<p><a name="2"><span class="atitle2">什么是Httptunnel</span></a> <br />作为一个实际的例子，我们下面来介绍一个在&#8221;非公开领域&#8221;使用的的通道软件，httptunnel。在httptunnel主页（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）上有这么一端话，<br />httptunnel creates a bidirectional virtual data connection tunnelled in HTTP requests. The HTTP requests can be sent via an HTTP proxy if so desired. <br />This can be useful for users behind restrictive firewalls. If WWW access is allowed through a HTTP proxy, it&#8217;s possible to use httptunnel and, say, telnet or PPP to connect to a computer outside the firewall. </p>
<p>从这段说明中我们可以看出来它就是我们今天说要介绍的tunnel技术的一个证明，我们下面大致介绍一下它的使用。</p>
<p>httptunnel目前比较稳定的版本是3.0.5, 支持各种常见的unix系统，包括window平台。可以从相关站点（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）下载，它的安装是比较简单的，照INSTALL文件做就可以了，这里不介绍。</p>
<p>整个软件安装完毕后，我们会得到两个关键文件，htc和hts,其中htc是客户端（c），而hts是server(s)端，我们来看看具体怎么使用的。</p>
<p>假设有A（域名client.yiming.com)机，B(域名server.yiming.com)机，两机均为solaris环境，A机在防火墙保护中，B机在防火墙以外，防火墙的管理员控制了访问规则，仅ALLOW 80和53端口的进出数据包。而我们的任务是要利用Httptunnel从A机telnet到B机上，穿过防火墙的限制。操作如下：</p>
<p>首先我们在A上启动client端，命令很简单：<br />client.yiming.com#htc -F 1234 server.yiming.com:80，</p>
<p>系统回到提示符下，此刻我们用netstat -an 可以看到系统内多出了1234端口的侦听 </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>*.1234                 *.*                0      0     0      0 LISTEN</code></pre>
</td>
</tr>
</tbody>
</table>
<p>然后我们在B机上启动server端，命令如下：<br />server.yiming.com#hts -F localhost:23 80</p>
<p>系统回到提示符下，此刻我们用netstat看 </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>*.80              *.*                0      0     0      0 LISTEN</code></pre>
</td>
</tr>
</tbody>
</table>
<p>80端口处于侦听状态，需要注意的是，如果系统本身跑的有web服务（80端口本身处于侦听），并不会影响Httptunnel的工作。</p>
<p>Ok,server以及client端都启动了，我们可以开始我们的&#8221;通道&#8221;试验了，在client.yiming.com上执行一下如下命令看看： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
Client.yiming.com#telnet localhost 1234
Trying 0.0.0.0...
Connected to 0.
Escape character is '^]'.
SunOS 5.7
This is yiming's private box! Any question,contact me with yiming@security.zz.ha.cn
login:
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>看到B机的登录提示符了,输入账号密码看看是否工作正常？ </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
Login:yiming
Password: (omit here;) )
sever.yiming.com# ls
bak         check       go          httpd       lost+found  mrtg        run         soft        wg
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>OK! 工作正常，和正常的telnet没有什么差别。</p>
<p>仔细观察整个过程，会发现在最开始的地方显示的是Trying 0.0.0.0&#8230;，Connected to 0.而不是Trying server.yiming.com…,Connect to server.yiming.com，这就很直观的可以看出来client端是转发1234数据包到本机80端口的。（然后再转发到远端）而不是直接连接远端的B机。</p>
<p>上面是比较直观的测试，为了进一步验证server和client之间不是通过23端口通讯，我们抓取数据包来看看。我们在server起个抓包工具tcpdump（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）瞧瞧。 </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
server.yiming.com#tcpdump host client.yiming.com
tcpdump: listening on hme0
14:42:54.213699 client.yiming.com.51767 &gt; server.yiming.com.80: S 1237977857:1237977857(0) win 8760  (DF)
14:42:54.213767server.yiming.com.80 &gt; client.yiming.com.51767: S 1607785698:1607785698(0) ack 1237977858 win 8760  (DF)
14:42:54.216186 client.yiming.com.51768 &gt; server.yiming.com.80: . ack 1 win 8760 (DF)
14:42:54.218661 client.yiming.com.51768 &gt; server.yiming.com.80: P 1:44(43) ack 1 win 8760 (DF)
14:42:54.218728 client.yiming.com.51768 &gt; server.yiming.com.80: P 44:48(4) ack 1 win 8760 (DF)
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>篇幅所限，上面只是截取了结果中的一点点数据包，但已经可以说明问题了，我们看到server和client之间顺利的完成了三次握手，然后开始push数据，而且通讯确实走的是80端口。有点意思噢。</p>
<p>看是看出来了，但太不直白，到底在搞什么呀，我们再稍微改动一下tcpdump的运行方式，进一步在来看看telnet的数据是否被封装在80端口的数据包内传输？</p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
server.yiming.com#tcpdump -X host client.yiming.com
14:43:05.246911 server.yiming.com.80 &gt; client.yiming.com.51768: . 2997:4457(1460) ack 89 win 8760 (DF)
0x0000   4500 05dc 3b23 4000 ff06 e2c2 yyyy yyyy        E...;#@......f.D
0x0010   xxxx xxxx 0050 de42 5fd5 ac4f 39ac 016f        .f.#.P.B_..O9..o
0x0020   5010 2238 98e4 0000 746f 7461 6c20 3636        P."8....total.66
0x0030   370d 0a64 7277 7872 2d78 722d 7820 2032        7..drwxr-xr-x..2
0x0040   3920 726f 6f74 2020 2020 2072 6f6f 7420        9.root.....root.
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>呵呵，这次清楚多了，上面应该是一次ls命令的输出结果，可以清楚的看到telnet的结果！果然telnet的数据是在80端口的数据包内！ </p>
<p><a name="3"><span class="atitle2">Httptunnel带来的安全问题</span></a> <br />写到这里，我们可以想象一下，如果管理员完全信赖防火墙，那么在一个有这样隐患的的局域网中，会发生什么样的后果？</p>
<p>我们可以看到，多年以来，对防火墙的依赖也一直列在SANS的Top 10安全问题中。</p>
<p>既然如此，就很自然的会产生一个问题是：这种httptunnel行为能被发现吗？</p>
<p>首先我们想到的是使用入侵检测系统，在目前的网络安全设计中，防火墙加入侵检测系统是一种比较流行的安全联动配置，既然httptunnel绕过了防火墙，那么IDS系统呢？我们来测测看看。</p>
<p>在下面的测试中，我们将使用IDS系统是Snort，版本1.8.2。（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）这可是大名鼎鼎的开放源代码的IDS系统，在它的说明中，被描述为一个轻量级的，可跨平台工作的入侵检测系统，在2001年12月英国的独立测试实验室NSS的评测中（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>），击败了包括商用IDS系统的所有对手，这些商用软件可是包括ISS，CISCO SECURE IDS，CA ETRUST，CYBERSAFE CENTRAX，NFR。有兴趣的读者还可以看这篇名为Open source mounts IDS challenge 的报道（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）。</p>
<p>好，对Snort的大致介绍完毕，我们来看看结果吧，Snort对整个试验过程抓获的数据包产成了告警，如下： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
[**] WEB-MISC whisker splice attack [**]
12/02-14:42:54.389175 client.yiming.com:51767-&gt; server.yiming.com:80
TCP TTL:251 TOS:0x0 ID:3327 IpLen:20 DgmLen:42 DF
***AP*** Seq: 0x49CA0BA7  Ack: 0x5FD4DCE3  Win: 0x2238  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

[**] WEB-MISC whisker splice attack [**]
12/02-14:43:03.195006 client.yiming.com:51767 -&gt; server.yiming.com:80
TCP TTL:251 TOS:0x0 ID:3439 IpLen:20 DgmLen:41 DF
***AP*** Seq: 0x49CA0C20  Ack: 0x5FD4DCE3  Win: 0x2238  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

[**] WEB-MISC whisker splice attack [**]
12/02-14:43:04.630268 client.yiming.com:51768-&gt; server.yiming.com:80
TCP TTL:251 TOS:0x0 ID:3496 IpLen:20 DgmLen:41 DF
***AP*** Seq: 0x49CA0C4E  Ack: 0x5FD4DCE3  Win: 0x2238  TcpLen: 20
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>我们看到snort对抓获的数据包产生了WEB-MISC whisker splice attack的告警，然而这种攻击并没有发生，同时snort对tunnel数据包没有察觉。这样snort就同时出现了IDS系统的两个问题，false positive，false negative。</p>
<p>这也很正常，因为这也是基于签名的IDS系统的通病，目前决大数IDS系统包括著名的商用软件ISS,NFR等都是基于签名的，也就是说系统维护着一套特定攻击数据包的数据模式签名。系统工作时，检查经过的数据包的内容，和自己数据库内数据模式签名对比，如果和某种攻击模式签名相同，那么就判断发生了某种攻击。</p>
<p>由此我们可以看出很明显的存在若干问题：如对签名的依赖不可避免的导致两个结果，false negative ,false positive。也就是说会产生漏报和误报，这一点很容易理解，当新出现一种攻击模式时，由于IDS系统内没有相应的数据签名，那么就不可能捕获相应的攻击数据包，false negative由此发生。同时，过于依赖签名模式也很容易误报，就象我们上面的例子。同时，对数据签名的依赖会在一定程度上降低系统性能-经过的数据包都需要和IDS系统的签名对照。（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）</p>
<p>此外，基于签名的IDS系统本身有可能由于依据签名这一特性而被攻击，一个例子是stick ，这个程序的作者利用IDS系统进行签名匹配工作原理，发送大量带有攻击特征的数据包给IDS系统，使IDS系统本身处理能力超过极限，从而导致IDS系统无法响应。按照作者Coretez Giovanni的说法，运行2秒钟stick就能使著名的商用IDS系统ISS real secure崩溃。由上我们看到，对IDS系统的完全依赖同样是有风险的。（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）</p>
<p><a name="4"><span class="atitle2">一些解决思路</span></a> <br />看来依靠手头的IDS是无法察觉这种行为了，那么有其它办法吗？我们仔细分析一下事件过程中截获的httptunnel数据包再说吧。</p>
<p>仔细观察截获的httptunnel数据包，可以发现紧跟着三次握手完成后的第一个数据包包含着一个POST动作，是由htc（client端）发送到hts(server端)的。如下： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>14:55:39.128908 client.yiming.com.51767 &gt; server.yiming.com.80: S 3521931836:3521931836(0) win 8760  (DF)
0x0000   4500 002c d3cc 4000 fb06 53c9 xxxx xxxx        E..,..@...S..f.#
0x0010   yyyy yyyy ca37 0050 d1ec 6a3c 0000 0000        .f.D.7.P..j&lt;....
0x0020   6002 2238 1708 0000 0204 05b4 0000             `."8..........
14:55:39.128945 server.yiming.com.80 &gt; client.yiming.com.51767: S 2946004964:2946004964(0) ack 3521931837 win 8760  (DF)
0x0000   4500 002c cb85 4000 ff06 5810 yyyy yyyy        E..,..@...X..f.D
0x0010   xxxx xxxx 0050 ca37 af98 77e4 d1ec 6a3d        .f.#.P.7..w...j=
0x0020   6012 2238 ef79 0000 0204 05b4                  `."8.y......
14:55:39.131002 client.yiming.com.51767 &gt; server.yiming.com.80: . ack 1 win 8760 (DF)
0x0000   4500 0028 d3cd 4000 fb06 53cc xxxx xxxx        E..(..@...S..f.#
0x0010   yyyy yyyy ca37 0050 d1ec 6a3d af98 77e5        .f.D.7.P..j=..w.
0x0020   5010 2238 0737 0000 0000 0000 0000             P."8.7........
14:55:39.132841 server.yiming.com.80 &gt; client.yiming.com.51767: . ack 44 win 8760 (DF)
0x0000   4500 0028 cb86 4000 ff06 5813 yyyy yyyy        E..(..@...X..f.D
0x0010   xxxx xxxx 0050 ca37 af98 77e5 d1ec 6a68        .f.#.P.7..w...jh
0x0020   5010 2238 070c 0000                            P."8....
14:55:39.132860 client.yiming.com.51767 &gt; server.yiming.com.80: P 1:44(43) ack 1 win 8760 (DF)
0x0000   4500 0053 d3ce 4000 fb06 53a0 xxxx xxxx        E..S..@...S..f.#
0x0010   yyyy yyyy ca37 0050 d1ec 6a3d af98 77e5        .f.D.7.P..j=..w.
0x0020   5018 2238 d23a 0000 504f 5354 202f 696e        P."8.:..POST./in
0x0030   6465 782e 6874 6d6c 3f63 7261 703d 3130        dex.html?crap=10
0x0040   3037 3838 3034 3836 2048 5454 502f 312e        07880486.HTTP/1.
0x0050   310d 0a                                        1..
                                     1..
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>看起来是发送client端的数据包到server端的，那么server有什么反应呢？我们往下看,在上面这个过程完成后，htc和hts又发生了一次握手（注意，又一次握手），如下： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
14:55:39.134301 client.yiming.com.51768 &gt; server.yiming.com.80: S 2851199448:2851199448(0) win 8760  (DF)
0x0000   4500 002c d3df 4000 fb06 53b6 xxxx xxxx        E..,..@...S..f.#
0x0010   yyyy yyyy ca38 0050 a9f1 d9d8 0000 0000        .f.D.8.P........
0x0020   6002 2238 cf65 0000 0204 05b4 0000             `."8.e........
14:55:39.134389 server.yiming.com.80 &gt; client.yiming.com.51768: S 2946060449:2946060449(0) ack 2851199449 win 8760  (DF)
0x0000   4500 002c cb8f 4000 ff06 5806 yyyy yyyy        E..,..@...X..f.D
0x0010   xxxx xxxx 0050 ca38 af99 50a1 a9f1 d9d9        .f.#.P.8..P.....
0x0020   6012 2238 cf19 0000 0204 05b4                  `."8........
14:55:39.136527 client.yiming.com.51768 &gt; server.yiming.com.80: . ack 1 win 8760 (DF)
0x0000   4500 0028 d3e0 4000 fb06 53b9 xxxx xxxx        E..(..@...S..f.#
0x0010   yyyy yyyy ca38 0050 a9f1 d9d9 af99 50a2        .f.D.8.P......P.
0x0020   5010 2238 e6d6 0000 0000 0000 0000             P."8..........
14:55:39.137333 client.yiming.com.51768 &gt; server.yiming.com.80: P 1:43(42) ack 1 win 8760 (DF)
0x0000   4500 0052 d3e1 4000 fb06 538e xxxx xxxx        E..R..@...S..f.#
0x0010   yyyy yyyy ca38 0050 a9f1 d9d9 af99 50a2        .f.D.8.P......P.
0x0020   5018 2238 25ce 0000 4745 5420 2f69 6e64        P."8%...GET./ind
0x0030   6578 2e68 746d 6c3f 6372 6170 3d31 3030        ex.html?crap=100
0x0040   3738 3830 3438 3620 4854 5450 2f31 2e31        7880486.HTTP/1.1
0x0050   0d0a                                           ..
14:55:39.137379 server.yiming.com.80 &gt; client.yiming.com.51768: . ack 43 win 8718 (DF)
0x0000   4500 0028 cb90 4000 ff06 5809 yyyy yyyy        E..(..@...X..f.D
0x0010   xxxx xxxx 0050 ca38 af99 50a2 a9f1 da03        .f.#.P.8..P.....
0x0020   5010 220e e6d6 0000                            P.".....
14:55:39.139733 client.yiming.com.51768 &gt; server.yiming.com.80: P 43:89(46) ack 1 win 8760 (DF)
0x0000   4500 0056 d3e2 4000 fb06 5389 xxxx xxxx        E..V..@...S..f.#
0x0010   yyyy yyyy ca38 0050 a9f1 da03 af99 50a2        .f.D.8.P......P.
0x0020   5018 2238 e156 0000 486f 7374 3a20 3230        P."8.V..Host:.20
0x0030   322e 3130 322e 3232 372e 3638 3a38 300d        2.102.227.68:80.
0x0040   0a43 6f6e 6e65 6374 696f 6e3a 2063 6c6f        .Connection:.clo
0x0050   7365 0d0a 0d0a                                 se....
14:55:39.151300 server.yiming.com.80 &gt; client.yiming.com.51768: P 1:170(169) ack 89 win 8760 (DF)
0x0000   4500 00d1 cb91 4000 ff06 575f yyyy yyyy        E.....@...W_.f.D
0x0010   xxxx xxxx 0050 ca38 af99 50a2 a9f1 da31        .f.#.P.8..P....1
0x0020   5018 2238 e721 0000 4854 5450 2f31 2e31        P."8.!..HTTP/1.1
0x0030   2032 3030 204f 4b0d 0a43 6f6e 7465 6e74        .200.OK..Content
0x0040   2d4c 656e 6774 683a 2031 3032 3430 300d        -Length:.102400.
0x0050   0a43 6f6e 6e65 6374 696f 6e3a 2063 6c6f        .Connection:.clo
0x0060   7365 0d0a 5072 6167 6d61 3a20 6e6f 2d63        se..Pragma:.no-c
0x0070   6163 6865 0d0a 4361 6368 652d 436f 6e74        ache..Cache-Cont
0x0080   726f 6c3a 206e 6f2d 6361 6368 652c 206e        rol:.no-cache,.n
0x0090   6f2d 7374 6f72 652c 206d 7573 742d 7265        o-store,.must-re
0x00a0   7661 6c69 6461 7465 0d0a 4578 7069 7265        validate..Expire
0x00b0   733a 2030 0d0a 436f 6e74 656e 742d 5479        s:.0..Content-Ty
0x00c0   7065 3a20 7465 7874 2f68 746d 6c0d 0a0d        pe:.text/html...
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>从数据包中可以看到，本次通讯中hts(server)端向htc(client)端发送了一个GET的标识包，估计是去&#8221;取&#8221;刚才client端发来的数据包，而且是一次新的握手！为了验证，我们分别在client,server端，执行netstat -an，结果证明了我们的观察是正确的，如下： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
client.yiming.com.51767        server.yiming.com.80     8760      0  8760      0 ESTABLISHED
client.yiming.com.51768        server.yiming.com.80     8760      0  8760      0 ESTABLISHED
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>在server端，执行netstat -an，结果如下： </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
server.yiming.com.80    client.yiming.com.51767  8760      0  8760      0 ESTABLISHED
server.yiming.com.80    client.yiming.com.51768  8760      0  8760      0 ESTABLISHED
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>果然，防火墙两边的系统都起了两个socket，和一般程序不同，这是个比较特殊的现象。</p>
<p>GET动作完成后，server端又向client端发送了一个数据包，内容是 </p>
<table bgcolor="#cccccc" border="1" cellpadding="5" cellspacing="0" width="100%">
<tbody>
<tr>
<td>
<pre><code>
HTTP/1.1 200 OK Content-Length: 102400
Connection: close
Pragma: no-cache 
Cache-Control: no-cache, no-store, must-revalidate 
Expires: 0 
Content-Type: text/html
</code></pre>
</td>
</tr>
</tbody>
</table>
<p>这里应该是定义数据包传输最大值等参数的。</p>
<p>作者察觉，经由了这三次htc和hts之间的作用后，httptunnel才真正的建立起来，后面的工作才能正常开展，而且很有意思的是，自此以后所有后续的数据包一律没有80端口经常走的GET,PUT,POST之类的内容！！这里看来可以想点办法。</p>
<p>上面说过，正常走80端口的数据包应该是web行为，那么就数据包中就应该少不了get等正常的动作内容，如果在80端口经过的数据总是没有这些东东，那么就肯定有问题了，</p>
<p>那么这种问题就有了一种解决方案，就是手工检查通过80端口通过的数据包，如果数据包是明文传送，那么就很容易发现这种行为。但这种行为也只能在理论上可行。在实际上的操作是不可能的，有没有比较成熟的这种产品呢？按照这个思路检索网上的数据，果然发现有种入侵检测e-Gap系统可以确实察觉及屏蔽httptunnel等通道软件的存在，它工作在tcp/ip的应用层，在应用层一级检测数据包的确切性，比如，检测80端口的数据包，如果看起来数据包中总是没有有效的数据（URL,get,put等参数），那么e-Gap系统就会报警，并中断连接行为。（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）</p>
<p>需要注意的是，这种侦测方法仅对明文传送的有效，如果数据被加密，那么也就无计可施了。那么再进一步，如果加密了呢？目前作者掌握的情况来看，StealthWatch硬件产品可能是一种比较好的选择，它完全摈弃了基于签名的工作模式，而是采用一种正在申请专利的基于flow-base构架策略，按照几家评测实验室的结果来看，可以有效的察觉已经公开和未公开的各种攻击，Dos，蠕虫，病毒等，甚至包括加密的通讯！但是，它的价钱也远远的超出了普通的商用IDS系统，一套齐备的设施需4万美元！具体效果作者目前没有条件测试。（请参阅<a href="http://www-900.ibm.com/developerWorks/security/l-httpunnel/index.shtml#resources" rel="nofollow" data-token="16dee82e8f7ac567ae8bac4f2ec2af16">参考资料</a>）</p>
<p><a name="5"><span class="atitle2">总结</span></a> <br />在我们的试验中，httptunnel同时逃过了防火墙的屏蔽以及入侵检测系统的追踪，这是值得思考的。我们可以看到，网络安全仅仅依靠某种或某几种手段是不可靠的，尤其是对安全性要求很高的应用系统，同时对安全系统的盲目依赖往往会造成巨大的安全隐患。</p>
<p>      <!-- RESOURCES --> </p>
<p><a name="resources"><span class="atitle2">参考资料</span></a> </p>
<ul class="n01">
<li>httptunnel主页<br /><a href="http://www.nocrew.org/software/httptunnel.html" rel="nofollow" data-token="258cc2f0b7ddd47f73c272564703ae98">http://www.nocrew.org/software/httptunnel.html</a> </li>
<li>httptunnel程序下载<br /><a href="ftp://ftp.nocrew.org/pub/nocrew/unix/httptunnel-3.0.5.tar.gz" rel="nofollow" data-token="27b4564701cd3a664ac829c3a9e79801">ftp://ftp.nocrew.org/pub/nocrew/unix/httptunnel-3.0.5.tar.gz</a> </li>
<li>tcpdump主页及相关资源<br /><a href="http://www.tcpdump.org/" rel="nofollow" data-token="8f82525fadc7a8efff60165df9f8018b">http://www.tcpdump.org</a> </li>
<li>SNORT主页及相关资源<br /><a href="http://www.snort.org/" rel="nofollow" data-token="cdd52f6a869fa7d61e06f0b1b6662efb">http://www.snort.org</a> </li>
<li>NSS关于IDS系统的评测报告<br /><a href="http://www.nss.co.uk/ids/index.htm" rel="nofollow" data-token="cfff4915850a1859be17cff11d72a045">http://www.nss.co.uk/ids/index.htm</a> </li>
<li>Open source mounts IDS challenge 的报道<br /><a href="http://www.vnunet.com/News/1127283" rel="nofollow" data-token="1ac33321561043839dcff7bfb528e763">http://www.vnunet.com/News/1127283</a> </li>
<li>文章&#8221;Insertion, Evasion, and Denial of Service: Eluding Network Intrusion Detection&#8221;<br /><a href="http://secinf.net/info/ids/idspaper/idspaper.html" rel="nofollow" data-token="d2307fb6c5ea4b4f7fbdb9f8b62138db">http://secinf.net/info/ids/idspaper/idspaper.html</a> </li>
<li>Stick作者主页<br /><a href="http://www.eurocompton.net/stick/projects8.html" rel="nofollow" data-token="a0ac8209c794537382c69d59b949bd0f">http://www.eurocompton.net/stick/projects8.html</a> </li>
<li>e-Gap产品<br /><a href="http://www.whalecommunications.com/" rel="nofollow" data-token="098be08629a4aecee6e258a1c6b1985d">http://www.whalecommunications.com</a> </li>
<li>StealthWatch产品<br /><a href="http://www.lancope.com/products" rel="nofollow" data-token="384eb83c15ae9c4cbeba36889b80bcf4">http://www.lancope.com/products</a> </li>
</ul>
<p>      <!-- AUTHOR BIOS --><br />
      <!-- Make author heading singular or plural as needed --> </p>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
<tr>
<td><a name="author1"><span class="atitle2">关于作者</span></a> <br />宫一鸣，男，26 岁，河南电信网络关键设备高级系统管理员，主任工程师，中国电信国家级跨世纪人才，中国电信网络安全小组核心成员，河南电信网络安全小组成员。您可以通过E-mail :<a href="mailto:yiming@security.zz.ha.cn" rel="nofollow" data-token="51489f3b54edee482a93b1e4be91024c">yiming@security.zz.ha.cn</a>或网站<a href="http://security.zz.ha.cn/" rel="nofollow" data-token="64500509698362b3d89fd0abce718bde">http://security.zz.ha.cn</a>联系他! </td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table></div>
</div>
]]></content:encoded>
										</item>
	</channel>
</rss>
